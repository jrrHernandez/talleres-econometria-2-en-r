rm(list = ls())
cat("\014")
#cargamos las librerias
require(pacman)
p_load(astsa, tidyverse, forecast, ggplot2, tseries, rio, fpp2, lubricate) # utilizamos la libreria astsa(Time series and its aplications).
Q_earnings <- ts(jj)
help(jj)
Q_earnings
help(autoplot)
Q_earnings <- ts(jj)
autoplot(Q_earnings)+
ggtitle("Ganancias trimestrales Johnson & Johnson")+
xlab("Año")+
ylab("Ganancias trimestrales por accion")+
theme_classic()
Q_earnings <- ts(jj, start = 1960, end = 1980)
autoplot(Q_earnings)+
ggtitle("Ganancias trimestrales Johnson & Johnson")+
xlab("Año")+
ylab("Ganancias trimestrales por accion")+
theme_classic()
Q_earnings <- ts(jj, start = 1960, end = 1980, frequency = 4)
autoplot(Q_earnings)+
ggtitle("Ganancias trimestrales Johnson & Johnson")+
xlab("Año")+
ylab("Ganancias trimestrales por accion")+
theme_classic()
#guardamos
setwd("C:\Users\richa\OneDrive - Universidad de los Andes\Universidad\octavo\Econometria 2\talleres\talleres-econometria-2-en-r\taller5\Resultados")
#guardamos
setwd("C:/Users/richa/OneDrive - Universidad de los Andes/Universidad/octavo/Econometria 2/talleres/talleres-econometria-2-en-r/taller5/Resultados/")
ggsave("Grafico1.png", plot  = last_plot())
ggsave("Grafico1.png", plot  = last_plot(),width = 16, height = 9)
autoplot(Q_earnings)+
ggtitle("Ganancias trimestrales Johnson & Johnson")+
xlab("Año")+
ylab("Ganancias trimestrales por accion")+
theme_classic()
#guardamos
setwd("C:/Users/richa/OneDrive - Universidad de los Andes/Universidad/octavo/Econometria 2/talleres/talleres-econometria-2-en-r/taller5/Resultados/")
ggsave("Grafico1.png", plot  = last_plot(),width = 16, height = 9)
#Descomponemos en patrones
plot(decompose(Q_earnings))
#guardar
ggsave("Grafico2.png", plot  = last_plot(), width = 16, height = 9)
#Descomponemos en patrones
plot(decompose(Q_earnings))
#guardar
ggsave("Grafico2.png", plot  = last_plot(), width = 16, height = 9)
#Descomponemos en patrones
plot(decompose(Q_earnings))
#guardar
ggsave("Grafico2.png", plot  = last_plot(), width = 16, height = 9)
last_plot()
ggseasonplot(Q_earnings, polar = TRUE)+
ggtitle("Comportamiento polar Estacional")+
xlab("Año")+
ylab("Ganancias trimestrales por accion")+
theme_classic()
ggseasonplot(Q_earnings, polar = TRUE)+
ggtitle("Comportamiento polar Estacional")+
xlab("Año")+
ylab("Ganancias trimestrales por accion")+
theme_bw()
ggsave("Grafico3.png", plot  = last_plot(), width = 16, height = 9)
ggsave("Grafico4.png", plot  = last_plot(), width = 16, height = 9)
help(astsa)
usaGDP <- ts(GDP)
usaGDP
usaGDP <- ts(GDP, start = 1960, end = 1980, frequency =4)
usaGDP
#unimos las bases de datos
jj_GDP <- cbind(Q_earnings, usaGDP)
View(jj_GDP)
# podria haber una correlacion entre el crecimiento economico general de estados\
#unidos con el alto y creciente sharevalue.
corr(Q_earnings,usaGDP)
# podria haber una correlacion entre el crecimiento economico general de estados\
#unidos con el alto y creciente sharevalue.
cor(Q_earnings,usaGDP)
#grafico de los 2
autoplot(jj_GDP, facets = TRUE)+
xlab("Year") + ylab("") +
ggtitle("Series de tiempo del PIB de EE.UU y ingresos por accion de J & J")
#guardamos
ggsave("Grafico5.png", plot = last_plot(), width = 16, height = 9)
#guardamos
ggsave("Grafico6.png", plot = last_plot(), width = 16, height = 9)
as.data.frame(jj_GDP)%>%
ggplot(aes(x = usaGDP, y = Q_earnings))+
geom_point()+
xlab("USA PIB") + ylab("Ganancias por accion de Johnson & Johnson") +
ggtitle("Grafico de puntos")+
theme_classic()
ggsave("grafico de puntos.png", plot = last_plot(), width = 16, height = 9)
#8#
ggAcf(Q_earnings)
print(acf(Q_earnings, lag.max = 10, type = "correlation" ,plot = FALSE))
print(acf(Q_earnings, lag.max = 10, type = "correlation" ))
#8#
ggAcf(Q_earnings)
,plot = FALSE
print(acf(Q_earnings, lag.max = 10, type = "correlation" ,plot = FALSE))
p_load(astsa, tidyverse, forecast, ggplot2, tseries, rio, fpp2, lubricate, writexl)
acfQE <- acf(Q_earnings, lag.max = 10, type = "correlation", plot = FALSE )
acfQE
write_xlsx(as.data.frame(cbind(acfQE$lag, acfQE$acf), "acf.xlsc")
write_xlsx(as.data.frame(cbind(acfQE$lag, acfQE$acf), "acf.xlsc"))
write_xlsx(as.data.frame(cbind(acfQE$lag, acfQE$acf), "acf.xlsx"))
write_xlsx(as.data.frame(cbind(acfQE$lag, acfQE$acf)), "acf.xlsx")
as.data.frame(jj_GDP)%>%
ggplot(aes(x = usaGDP, y = Q_earnings))+
geom_point()+
xlab("USA PIB") + ylab("Ganancias por accion de Johnson & Johnson") +
ggtitle("Grafico de puntos")+
theme_classic()
#8#
ggAcf(Q_earnings,lag.max = 10, type = "correlation")
print(acf(Q_earnings, lag.max = 10, type = "correlation" ,plot = FALSE))
acfQE <- acf(Q_earnings, lag.max = 10, type = "correlation", plot = FALSE )
write_xlsx(as.data.frame(cbind(acfQE$lag, acfQE$acf)), "acf.xlsx")
ggAcf(Q_earnings,lag.max = 10, type = "correlation")
??ma
#9#
ma(Q_earnings, order = 4)
Smooth_QEarnings <- ma(Q_earnings, order = 4)
#grafico
autoplot(Q_earnings, series = "Data")+
autolayer(Smooth_QEarnings, series = "5-MA")+
xlab("Año")+
ylab("Ganancias trimestrales por accion")+
scale_colour_manual( values = c("Data"="grey50","5-MA"="red"),
breaks = c("Data","5-MA" ))
Smooth_QEarnings5 <- ma(Q_earnings, order = 4)
#grafico
autoplot(Q_earnings, series = "Data")+
autolayer(Smooth_QEarnings, series = "5-MA")+
xlab("Año")+
title("Serie con Suavizamiento")
ylab("Ganancias trimestrales por accion")+
scale_colour_manual( values = c("Data"="grey50","5-MA"="red"),
breaks = c("Data","5-MA" ))+
ylab("Ganancias trimestrales por accion")+
scale_colour_manual( values = c("Data"="grey50","5-MA"="red"),
breaks = c("Data","5-MA" ))+
Smooth_QEarnings20 <- ma(Q_earnings, order = 20)
Smooth_QEarnings20 <- ma(Q_earnings, order = 20)
Smooth_QEarnings20 <- ma(Q_earnings, order = 10)
#grafico
autoplot(Q_earnings, series = "Data")+
autolayer(Smooth_QEarnings, series = "5-MA")+
autolayer(Smooth_QEarnings20, series = "20-MA")+
xlab("Año")+
title("Serie con Suavizamiento")+
ylab("Ganancias trimestrales por accion")+
scale_colour_manual( values = c("Data"="grey50","5-MA"="red", "20"),
breaks = c("Data","5-MA" ))+
#grafico
autoplot(Q_earnings, series = "Data")+
autolayer(Smooth_QEarnings, series = "5-MA")+
autolayer(Smooth_QEarnings20, series = "20-MA")+
xlab("Año")+
title("Serie con Suavizamiento")+
ylab("Ganancias trimestrales por accion")+
scale_colour_manual( values = c("Data"="grey50","5-MA"="red", "20-MA"="blue"),
breaks = c("Data","5-MA", "20-MA"))
Smooth_QEarnings5 <- ma(Q_earnings, order = 4)
Smooth_QEarnings20 <- ma(Q_earnings, order = 10)
#grafico
autoplot(Q_earnings, series = "Data")+
autolayer(Smooth_QEarnings, series = "5-MA")+
autolayer(Smooth_QEarnings20, series = "10-MA")+
xlab("Año")+
title("Serie con Suavizamiento")+
ylab("Ganancias trimestrales por accion")+
scale_colour_manual( values = c("Data"="grey50","5-MA"="red", "10-MA"="blue"),
breaks = c("Data","5-MA", "10-MA"))
last_plot()
ggsave("Grafico9.png", plot=last_plot(), width = 16, height = 9)
Q_earnings %>%
decompose(type = "additive")%>%
autoplot()+xlab("Año")+
ggtitle("Descomposición Aditiva clasica para ganancias trimestrales por accion de Johnson & Johnson")
last_plot()
ggsave("AdditiveDecomposition.png", plot = last_plot(), width = 16, height = 9)
#multiplicativa
Q_earnings %>%
decompose(type = "multiplicative")%>%
autoplot()+xlab("Año")+
ggtitle("Descomposición Multiplicativa clasica para ganancias trimestrales por accion de Johnson & Johnson")
ggsave("MultiplicativeDecomposition.png", plot=last_plot(), width = 16,height = 9)
